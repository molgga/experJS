<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>experJS\net\EXLoader.js</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.7.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.7.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/define.html">define</a></li>
            
                <li><a href="..&#x2F;classes/EX.html">EX</a></li>
            
                <li><a href="..&#x2F;classes/EXBrowser.html">EXBrowser</a></li>
            
                <li><a href="..&#x2F;classes/EXCheckBox.html">EXCheckBox</a></li>
            
                <li><a href="..&#x2F;classes/EXCheckBox.CheckBox.html">EXCheckBox.CheckBox</a></li>
            
                <li><a href="..&#x2F;classes/EXCompare.html">EXCompare</a></li>
            
                <li><a href="..&#x2F;classes/EXCookie.html">EXCookie</a></li>
            
                <li><a href="..&#x2F;classes/EXCustomEvent.html">EXCustomEvent</a></li>
            
                <li><a href="..&#x2F;classes/EXEasing.html">EXEasing</a></li>
            
                <li><a href="..&#x2F;classes/EXElement.html">EXElement</a></li>
            
                <li><a href="..&#x2F;classes/EXEvent.html">EXEvent</a></li>
            
                <li><a href="..&#x2F;classes/EXEventListener.html">EXEventListener</a></li>
            
                <li><a href="..&#x2F;classes/EXJsonLoader.html">EXJsonLoader</a></li>
            
                <li><a href="..&#x2F;classes/EXLoader.html">EXLoader</a></li>
            
                <li><a href="..&#x2F;classes/EXMath.html">EXMath</a></li>
            
                <li><a href="..&#x2F;classes/EXRadioButton.html">EXRadioButton</a></li>
            
                <li><a href="..&#x2F;classes/EXRadioButton.RadioButton.html">EXRadioButton.RadioButton</a></li>
            
                <li><a href="..&#x2F;classes/EXScrollViewY.html">EXScrollViewY</a></li>
            
                <li><a href="..&#x2F;classes/EXScrollViewY.UI_Bar.html">EXScrollViewY.UI_Bar</a></li>
            
                <li><a href="..&#x2F;classes/EXSelectBox.html">EXSelectBox</a></li>
            
                <li><a href="..&#x2F;classes/EXSelectBox.SelectBox.html">EXSelectBox.SelectBox</a></li>
            
                <li><a href="..&#x2F;classes/EXSelectBox.SelectBoxOption.html">EXSelectBox.SelectBoxOption</a></li>
            
                <li><a href="..&#x2F;classes/EXSelectBox.SelectBoxOptionGroup.html">EXSelectBox.SelectBoxOptionGroup</a></li>
            
                <li><a href="..&#x2F;classes/EXString.html">EXString</a></li>
            
                <li><a href="..&#x2F;classes/EXTextLoader.html">EXTextLoader</a></li>
            
                <li><a href="..&#x2F;classes/EXTimer.html">EXTimer</a></li>
            
                <li><a href="..&#x2F;classes/EXTiming.html">EXTiming</a></li>
            
                <li><a href="..&#x2F;classes/EXToast.html">EXToast</a></li>
            
                <li><a href="..&#x2F;classes/EXTransform.html">EXTransform</a></li>
            
                <li><a href="..&#x2F;classes/EXTween.html">EXTween</a></li>
            
                <li><a href="..&#x2F;classes/EXURLRequest.html">EXURLRequest</a></li>
            
                <li><a href="..&#x2F;classes/EXValidator.html">EXValidator</a></li>
            
                <li><a href="..&#x2F;classes/EXXmlLoader.html">EXXmlLoader</a></li>
            
                <li><a href="..&#x2F;classes/require.html">require</a></li>
            
                <li><a href="..&#x2F;classes/requirejs.html">requirejs</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: experJS\net\EXLoader.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define(function(require , exports){
	var EXURLRequest = require(&quot;.&#x2F;EXURLRequest&quot;);
	var EXCustomEvent = require(&quot;..&#x2F;events&#x2F;EXCustomEvent&quot;);

	var EXLoader = {};
	var isIE8Under = (function(){
		var ieVer = -1;
		var ua = navigator.userAgent;
		var re  = new RegExp(&quot;MSIE ([0-9]{1,}[\.0-9]{0,})&quot;);
		if (re.exec(ua) != null) ieVer = parseFloat( RegExp.$1 );
		if(ieVer != -1 &amp;&amp; ieVer &lt;= 8){
			return true;
		}
		return false;
	})();

	var isFF = &#x2F;Firefox&#x2F;.test(navigator.userAgent);
	&#x2F;**
	&lt;strong&gt;(beta)&lt;&#x2F;strong&gt; 데이터를 load 할 수 있는 객체입니다.
	&lt;br&#x2F;&gt;데이터를 추가(addURL)하여 여러개의 데이터를 순차적으로 받는것을 지원합니다.
	&lt;br&#x2F;&gt;예제는 XmlLoader , ImageLoader 객체에서 참고하시기 바랍니다.
	@class EXLoader
	@constructor
	@param [method=&quot;GET&quot;] {String} HTTP Request 방식을 지정합니다. (GET || HEAD || POST || PUT || DELETE || OPTION || TRACE)
	@param [asynchronous=true] {boolean} 비동기(true), 동기(false) 통신 방식을 지정합니다.
	 *&#x2F;
	EXLoader = function(method , asynchronous){
		var _loader = this;
		if(method == undefined){
			_loader.method = &quot;GET&quot;;
		}else{
			_loader.method = method;
		}
		
		_loader.asynchronous = (asynchronous == false) ? false : true;
		_loader.header = {};
		_loader.header[&quot;Content-type&quot;] = &quot;application&#x2F;x-www-form-urlencoded&quot;;
		_loader.mimeType = &quot;application&#x2F;x-www-form-urlencoded&quot;;
	};
	
	&#x2F;**
	cache 를 사용할지 여부를 지정합니다.
	@method setCache
	@param cache {boolean} cache 를 사용할지 여부를 지정합니다.
	 *&#x2F;
	EXLoader.prototype.setCache = function(cache){
		var _loader = this;
		if(cache == false){
			_loader.header[&quot;Cache-Control&quot;] = &quot;no-cache&quot;;
			_loader.header[&quot;Expire&quot;] = new Date();
			_loader.header[&quot;Pragma&quot;] = &quot;no-cache&quot;;
		}
	}
	
	&#x2F;**
	통신 방식을 지정합니다.
	@method setMethod
	@param method {String} HTTP Request 방식을 지정합니다. (GET || HEAD || POST || PUT || DELETE || OPTION || TRACE)
	 *&#x2F;
	EXLoader.prototype.setMethod = function(method){
		var _loader = this;
		if(method != undefined) _loader.method = method;
	}
	
	&#x2F;**
	비동기, 동기 방식을 지정합니다.
	@method setAsynchronous
	@param asynchronous {boolean} {boolean} 비동기(true), 동기(false) 통신 방식을 지정합니다.
	 *&#x2F;
	EXLoader.prototype.setAsynchronous = function(asynchronous){
		var _loader = this;
		_loader.asynchronous = (asynchronous == false) ? false : true;
	}
	EXLoader.prototype._addURLData = null;
	EXLoader.prototype._responseData = null;
	EXLoader.prototype._loadTotal = null;
	EXLoader.prototype._loadCnt = null;
	EXLoader.prototype._urlRequest = null;

	&#x2F;**
	Loader 객체를 초기화 합니다.
	@method init
	@return {void}
	*&#x2F;
	EXLoader.prototype.init = function(){
		var _loader = this;
		_loader._addURLData = [];
		_loader._responseData = {};
		_loader._loadTotal = 0;
		_loader._loadCnt = 0;
		_loader._urlRequest = new EXURLRequest();

		&#x2F;&#x2F;var progressInterval = null;
		var bytesTotal = 0;
		var bytesLoaded = 0;
		_loader._urlRequest.onreadystatechange = function(){
			switch(_loader._urlRequest.readyState){
				case 0: &#x2F;&#x2F;초기화안됨 uninitialized
					break;
				case 1: &#x2F;&#x2F;읽는중 load
					EXEventListener.dispatch( _loader , new EXCustomEvent(EXLoader.EVENT_START));
					break;
				case 2: &#x2F;&#x2F;읽기완료 loaded
					if(isIE8Under == false) bytesTotal = _loader._urlRequest.getResponseHeader(&quot;Content-Length&quot;);
					break;
				case 3: &#x2F;&#x2F;작업중 load progress
					&#x2F;&#x2F;bytesLoaded
					&#x2F;&#x2F;크롬, 사파리 : _loader._urlRequest.response 
					&#x2F;&#x2F;크롬, 사파리, 파폭 : _loader._urlRequest.responseText
					&#x2F;&#x2F;console.log(_loader._urlRequest.responseText.length);

					&#x2F;&#x2F;bytesTotal
					&#x2F;&#x2F;한번만 체크하면 됨.
					&#x2F;&#x2F;console.log(_loader._urlRequest.getResponseHeader(&quot;Content-Length&quot;));
					&#x2F;&#x2F;console.log(_loader._urlRequest.responseText.length);
					
					var customEvent = new EXCustomEvent(EXLoader.EVENT_PROGRESS);

					if(isIE8Under == false){
						if(bytesTotal &lt;= 0 ) bytesTotal = _loader._urlRequest.getResponseHeader(&quot;Content-Length&quot;);
						bytesLoaded = _loader._urlRequest.responseText.length;


						customEvent.bytesLoaded = bytesLoaded;
						customEvent.bytesTotal = bytesTotal;
						customEvent.bytesPercent = bytesLoaded&#x2F;bytesTotal;
					}

					EXEventListener.dispatch( _loader , customEvent);
					break;

				case 4: &#x2F;&#x2F;작업완료
					&#x2F;&#x2F;clearInterval(progressInterval);
					&#x2F;&#x2F;progressInterval = null;

					if(_loader._urlRequest.status == 200){
						_loader.stateComplete();
						
						var urlData = _loader._addURLData[_loader._loadCnt];
						var urlDataId = urlData.id;
						var responseData = {};
						responseData[urlDataId] = _loader._responseData[urlDataId];
						EXEventListener.dispatch( _loader , new EXCustomEvent(EXLoader.EVENT_COMPLETE , responseData));
						_loader._loadCnt++;
						if(_loader._loadCnt &lt; _loader._loadTotal){
							_loader.load();
						}else{
							_loader.stateCompleteAll();
						}
					}else{
						EXEventListener.dispatch( _loader , new EXCustomEvent(EXLoader.EVENT_ERROR ));
					}
					break;
			}
		};
	};

	&#x2F;**
	load 할 데이터의 URL과 id를 지정합니다.
	&lt;br&#x2F;&gt;메소드 명에서 알 수 있듯 하나의 Loader 객체로 부터 여러개의 데이터를 추가하여 load 할 수 있습니다.
	&lt;br&#x2F;&gt;id 는 Loader 객체로 부터 로드가 완료된 후 데이터를 전달 받기 위해 필요합니다.
	@method addURL
	@param url {String} 데이터 URL
	@param id {String} 데이터 id (데이터 id는 Loader 객체로 부터 데이터를 전달 받을 때 사용합니다.)
	@return {void}
	*&#x2F;
	EXLoader.prototype.addURL= function(url , id){
		var _loader = this;
		_loader._addURLData.push({ id:id , url:url });
		_loader._loadTotal = _loader._addURLData.length;
	};

	&#x2F;**
	XMLHttpRequest 를 통해 전달할 파라미터를 지정합니다.
	@method setParams
	@param paramsObj {Object} XMLHttpRequest 를 통해 전달할 파라미터
	@return {void}
	*&#x2F;
	EXLoader.prototype.setParams = function(paramsObj){
		var _loader = this;
		if(paramsObj == undefined){
			_loader.params = null;
		}else{
			var pms = [];
			var key = null;
			var value = &quot;&quot;;
			var whiteSpaceReg = &#x2F;%20&#x2F;g;
			for(key in paramsObj){
				value = paramsObj[key];
				pms.push(encodeURIComponent(key).replace(whiteSpaceReg , &quot;+&quot;) + &quot;=&quot; + encodeURIComponent(value).replace(whiteSpaceReg , &quot;+&quot;));
			}
			_loader.params = pms.join(&quot;&amp;&quot;);
		}
	};
	
	&#x2F;**
	load 를 시작합니다.
	@method load
	@return {void}
	*&#x2F;
	EXLoader.prototype.load = function(){
		var _loader = this;
		var _urlRequest = _loader._urlRequest;
		var method = _loader.method;
		var url = _loader._addURLData[_loader._loadCnt].url;
		var asynchronous = _loader.asynchronous;
		_urlRequest.open(method , url , asynchronous);
		if(method == &quot;GET&quot;){
			var headers = _loader.header;
			var key;
			for(key in headers){
				_urlRequest.setRequestHeader( key , headers[key] );
			}
		}
		if(_urlRequest.overrideMimeType != undefined &amp;&amp; _loader.mimeType != null) _urlRequest.overrideMimeType(_loader.mimeType);
		_urlRequest.send(_loader.params);
	};

	EXLoader.prototype.stateLoad = function(){};
	EXLoader.prototype.stateLoaded = function(){};
	EXLoader.prototype.stateProgress = function(){};
	EXLoader.prototype.stateComplete = function(){};
	EXLoader.prototype.stateCompleteAll = function(){
		EXEventListener.dispatch( this , new EXCustomEvent(EXLoader.EVENT_COMPLETE_ALL , this._responseData ));
	};
	
	
	&#x2F;**
	Loader 객체에서 사용된 모든 자원을 해제합니다.
	@method destroy
	@return {void}
	*&#x2F;
	EXLoader.prototype.destroy = function(){
		var _loader = this;
		try{
			var i , key , len;
			if(_this._addURLData){
				len = _loader._addURLData.length;
				for(i  = 0 ; i &lt; len ; i++){
					for(key in _loader._addURLData[i]) delete _loader._addURLData[i][key];
				}
				_loader._addURLData = null;
			}
			if(_loader._responseData){
				for(key in _loader._responseData) delete _loader._responseData[key];
			}
			if(_loader._urlRequest){
				_loader._urlRequest.abort();
				_loader._urlRequest = null;
			}
			_loader._loadTotal = null;
			_loader._loadCnt = null;
			_loader = null;
		}catch(e){
			&#x2F;&#x2F;EXEventListener.dispatch( _loader , new EXCustomEvent(EXLoader.EVENT_ERROR , { error:e } ));
		}
	};



	&#x2F;**
	Loader 객체의 load 가 시작되는 시점에 dispatch 합니다.
	@event Loader.EVENT_START
	*&#x2F;
	EXLoader.EVENT_START = &quot;EXLoader.EVENT_START&quot;;

	&#x2F;**
	Loader 객체의 addURL 을 통해 추가된 개별 데이터를 로드 완료되는 시점에 dispatch 합니다.
	@event Loader.EVENT_COMPLETE
	*&#x2F;
	EXLoader.EVENT_COMPLETE = &quot;EXLoader.EVENT_COMPLETE&quot;;

	&#x2F;**
	비동기 통신방식으로 생성된 Loader 객체의 데이터 progress 시점에 dispatch 합니다.
	&lt;br&#x2F;&gt;loadedByte 등은 지원하지 않습니다.
	@event Loader.EVENT_PROGRESS
	*&#x2F;
	EXLoader.EVENT_PROGRESS = &quot;EXLoader.EVENT_PROGRESS&quot;;

	&#x2F;**
	Loader 객체의 addURL 을 통해 추가된 모든 데이터를 로드 완료되는 시점에 dispatch 합니다.
	@event Loader.EVENT_COMPLETE_ALL
	*&#x2F;
	EXLoader.EVENT_COMPLETE_ALL = &quot;EXLoader.EVENT_COMPLETE_ALL&quot;;

	&#x2F;**
	Loader 객체에서 error 가 발생하는 시점에 dispatch 합니다.
	@event Loader.EVENT_ERROR
	*&#x2F;
	EXLoader.EVENT_ERROR = &quot;EXLoader.EVENT_ERROR&quot;;
	
	return EXLoader;
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
